# 管理ダッシュボードシステム（MVP）要件まとめ（ドラフト）

- 対象: 管理者（運用者）
- 目的: 会員・注文・配送先を Web ブラウザ上で一元管理できるようにする
- 前提: Django 標準機能を最大限利用し、短期間で安定稼働（将来の拡張を妨げない）

## 目次

- [概要](#概要)
- [システム構成](#システム構成)
- [スコープ定義](#スコープ定義)
- [ユーザー要件](#ユーザー要件)
- [認証・認可要件](#認証認可要件)
- [画面要件](#画面要件)
- [データ要件（テーブル定義・MVP）](#データ要件テーブル定義mvp)
- [非機能要件](#非機能要件)
- [受け入れ条件（MVP）](#受け入れ条件mvp)
- [今後の拡張余地（次フェーズ）](#今後の拡張余地次フェーズ)
- [関連ドキュメント](#関連ドキュメント)

## 概要

### システム名称（仮）

管理ダッシュボードシステム（MVP）

### 目的

メールアドレス＋パスワードでログイン可能な管理用ダッシュボードを構築し、注文管理・会員情報・配送先情報を Web ブラウザ上で一元管理できるようにする。

### MVPの定義（方針）

- Django 標準機能を最大限利用し、短期間で安定稼働させる
- 管理者（運用者）が業務を回せる「最小機能」を実装する
- 将来の拡張（API 化 / Next.js 化）を妨げない構成にする

## システム構成

### 技術スタック

| 区分 | 技術 |
| --- | --- |
| フレームワーク | Django |
| フロントエンド | Django Template（SSR） |
| 認証 | Django 標準認証（セッション） |
| DB | Supabase PostgreSQL |
| ORM / Migration | Django ORM |
| デプロイ | 未定（Render / Fly.io / EC2 等を想定） |

## スコープ定義

### 対象範囲（MVPで実装する）

- ログイン / ログアウト
- ログイン必須のダッシュボード
- サイドバー付き共通レイアウト
- 以下 5 画面の実装
  - ホーム
  - 新規注文
  - 注文履歴
  - 会員情報
  - 配送先
- Supabase（Postgres）へのデータ永続化

### 対象外（MVPでは実装しない）

- 決済機能
- 商品マスタ / 注文明細
- 在庫管理
- 権限ロール（管理者 / 一般など）
- 外部連携（メール送信、Webhook 等）
- CSV 入出力
- 監査ログ / 操作ログ
- Next.js / SPA / REST API

## ユーザー要件

### 利用ユーザー

- 管理者（運用者）
  - 会員・注文・配送先の登録および確認を行う
- ※ MVP では「一般ユーザー」「エンドユーザー」は存在しない

## 認証・認可要件

### 認証方式

- メールアドレス＋パスワード
- Django 標準認証（セッション方式）

### 認可

- ログインしていないユーザーはダッシュボードへアクセス不可
- すべてのダッシュボード画面は `login_required`

## 画面要件

### 共通仕様

- サイドバーを常時表示
- 右上にログアウトボタンを配置
- 未ログイン時はログイン画面へリダイレクト

### 画面一覧（MVP）

| 画面 | 目的 | 主な機能 |
| --- | --- | --- |
| ログイン | 管理者がシステムへログインする | 認証成功でホームへ / 失敗時エラー表示 |
| ホーム | ダッシュボードのトップページ | 固定テキスト、（任意）簡易集計表示 |
| 新規注文 | 注文情報を登録する | 会員・配送先選択、登録後に注文履歴へ |
| 注文履歴 | 注文の一覧を確認する | 一覧表示（ページング任意）、詳細は省略可 |
| 会員情報 | 会員情報を管理する | 一覧表示、編集 |
| 配送先 | 配送先情報を管理する | 一覧表示、新規登録、編集 |

### ログイン画面

- **目的**: 管理者がシステムへログインする
- **入力項目**
  - メールアドレス
  - パスワード
- **動作**
  - 認証成功 → ホーム画面へ遷移
  - 認証失敗 → エラーメッセージ表示

### ホーム

- **目的**: ダッシュボードのトップページ
- **表示内容（MVP）**
  - 固定テキスト（例: ようこそ）
  - （任意）直近注文数などの簡易情報

### 新規注文

- **目的**: 注文情報を登録する
- **入力項目**
  - 会員（選択）
  - 配送先（選択）
  - ステータス（初期値: 受付）
  - メモ（任意）
- **ステータス候補（MVP）**: 受付 / 対応中 / 完了 / キャンセル
- **動作**
  - 登録ボタンで注文を作成
  - 作成後、注文履歴画面へ遷移

### 注文履歴

- **目的**: 注文の一覧を確認する
- **表示項目**
  - 注文ID
  - 作成日時
  - 会員名
  - ステータス
  - 配送先（簡易）
- **操作**
  - 一覧表示（ページングは任意）
  - 詳細表示（MVP では省略可）

### 会員情報

- **目的**: 会員情報を管理する
- **項目**
  - 氏名
  - メールアドレス
  - 電話番号（任意）
- **操作**
  - 会員一覧表示
  - 会員情報の編集

### 配送先

- **目的**: 配送先情報を管理する
- **項目**
  - 配送先名
  - 郵便番号
  - 住所1（都道府県・市区町村）
  - 住所2（番地等）
  - 宛名
  - 電話番号（任意）
- **操作**
  - 一覧表示
  - 新規登録
  - 編集

## データ要件（テーブル定義・MVP）

### テーブル一覧

- User（Django 標準）
- Member（会員）
- ShippingAddress（配送先）
- Order（注文）

### リレーション（要点）

- Member（1）-（N）ShippingAddress
- Member（1）-（N）Order
- ShippingAddress（1）-（N）Order

### User（Django標準）

| カラム | 備考 |
| --- | --- |
| id |  |
| email | ログインID |
| password |  |
| is_active |  |
| created_at |  |

### Member（会員）

| カラム | 備考 |
| --- | --- |
| id |  |
| name | 氏名 |
| email | ユニーク |
| phone | nullable（任意） |
| is_active | 論理削除フラグ（false=無効） |
| created_at |  |
| updated_at |  |

### ShippingAddress（配送先）

| カラム | 備考 |
| --- | --- |
| id |  |
| member_id | FK（Member） |
| label | 配送先名（表示用） |
| postal_code |  |
| address1 | 都道府県・市区町村 |
| address2 | 番地等 |
| recipient_name | 宛名 |
| phone | nullable（任意） |
| is_active | 論理削除フラグ（false=無効） |
| created_at |  |
| updated_at |  |

### Order（注文）

| カラム | 備考 |
| --- | --- |
| id |  |
| member_id | FK（Member） |
| shipping_address_id | FK（ShippingAddress） |
| status | 初期値: 受付（候補: 受付/対応中/完了/キャンセル） |
| memo | nullable（任意） |
| created_at |  |
| updated_at |  |

## 非機能要件

### セキュリティ

- パスワードはハッシュ化して保存
- CSRF 対策を有効化
- HTTPS 前提（本番）

### 性能

- 同時利用: 〜10 ユーザー想定
- 注文数: 数千件程度まで想定

### 運用

- 管理者ユーザーは Django 管理画面 or コマンドで作成
- DB 接続情報は環境変数で管理

## 受け入れ条件（MVP）

- [ ] ログインしないとダッシュボードに入れない
- [ ] ログイン後、サイドバーが表示される
- [ ] 指定 5 画面すべてに遷移できる
- [ ] 注文を登録すると注文履歴に表示される
- [ ] 会員・配送先が登録・編集できる

## 今後の拡張余地（次フェーズ）

- Django REST Framework 導入
- Next.js フロント追加
- Supabase Auth 連携
- 権限管理（ロール）
- 商品・注文明細
- CSV 入出力
- 監査ログ

## 関連ドキュメント

- データ記録（DB設計・制約）: `docs/data-recording.md`